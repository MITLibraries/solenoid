{% load crispy_forms_field %}

{% if field.is_hidden %}
  {{ field }}
{% else %}
  <div class="field-wrap {% if wrapper_class %} {{ wrapper_class }}{% endif %}{% if form_show_errors%}{% if field.errors %} error{% endif %}{% endif %}{% if field.css_classes %} {{ field.css_classes }}{% endif %}" id="div_{{ field.auto_id }}">
    {% if field.label and not field|is_checkbox and form_show_labels %}
      <label for="{{ field.id_for_label }}" class="field-label {{ label_class }}{% if field.field.required %} requiredField{% endif %}">
        {{ field.label|safe }}
      </label>
    {% endif %}

    {# Checkbox multiselect fields #}
    {% if field|is_checkboxselectmultiple %}
      {% include 'mitlib_crispy/layout/checkboxselectmultiple.html' %}
    {% endif %}

    {# Radio buttons #}
    {% if field|is_radioselect %}
      {% include 'mitlib_crispy/layout/radioselect.html' %}
    {% endif %}

    {# All other field types #}
    {% if not field|is_checkboxselectmultiple and not field|is_radioselect %}

      {# Checkboxes #}
      {% if field|is_checkbox and form_show_labels %}
        <label for="{{ field.id_for_label }}" class="field-checkbox {% if field.field.required %} requiredField{% endif %}">
          {% crispy_field field %}
          {{ field.label|safe }}
        </label>

      {# All remaining fields #}
      {% else %}
        {% comment %}
          There's a lot of internal Django magic going on with field
          construction; this tag is ultimately pulling from HTML generated by
          Django, not from templates. If you want to style the inputs - as we
          do with the mitlib stylesheet - then, in forms.py, add css classes
          directly to the widgets in __init__; for example,
          self.fields['first_name'].widget.attrs['class'] = 'field field-text'
        {% endcomment %}
        {% crispy_field field %}
      {% endif %}
      {% include 'mitlib_crispy/layout/help_text_and_errors.html' %}
    {% endif %}
  </div>
{% endif %}
